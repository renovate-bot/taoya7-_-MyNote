### 协议三要素

- 语法(一段内容要符合一定的规则和格式)
- 语义(内容要代表某种意义)
- 顺序

### 网络协议

| 网络层     | 协议                                                     |
| ---------- | -------------------------------------------------------- |
| 应用层     | `DHCP` `HTTP` `HTTPS` `RTMP` `P2P`   `DNS`   `GTP` `RPC` |
| 传输层     | `UDP`  `TCP`                                             |
| 网络层     | `ICMP`  `IP`  `OSPF`, `BGP`, `IPSec`, `GRE`              |
| 数据链路层 | `ARP` `VLAN` ` STP`                                      |
| 物理层     | 网络跳线                                                 |

1. 物理层：连接
2. 链路层：定位
3. 传输层：路由
4. 会话层：会话连接机制
5. 应用层：数据封装格式 


### Mac地址与IP地址

MAC地址和设备是一一对应且全球唯一的，MAC地址是硬件提供商写在网卡中的，获取MAC地址是通过ARP协议来完成

互联网采用`IP+MAC`地址通信方式。是先有MAC地址后有的IP


IP是负责三层通信通过查找路由表，层层传递，最终到达目的设备，Mac负责二层通信，设备上的ARP表是IP和Mac的对应关系，通过ARP表找到目标IP的Mac地址

> **有了mac地址为什么还要有ip地址**

 把MAC地址比作身份证号（出生地），IP地址比作现地址

身份证号是你的唯一标识，不会重复，一落户就有（网卡一出厂就有mac）。现在我要和你通信（写信给你），地址用你的姓名+身份证，信能送到你手上吗? 明显不能！身份证号前六位能定位你出生的县。mac地址前几位也可以定位生产厂家。但是你出生后会离开这个县（哪怕在这个县，也不能具体找到你）。所以一般写个人信息就要有出生地和现居地址了

---

> **网络层上**

IP是网络层使用的，而MAC是链路层使用的，IP包最终还是要通过物理链接和MAC地址进行交互的

---


> **如何理解MAC地址**

IP是地址，有定位功能；MAC是身份证，无定位功能

## IP

IP是32位二进制数表示的，由网络号和主机号表示即`net-id` 与`host-id`

子网掩码和IP地址按位计算AND，就可得到**网络号**

### IP分类

![](http://itaolaity.com/20190714225343.png)

一共分为5类，依据是net-id所占的字节长度以及网络号前几位

### 特殊的IP

1. `{0,0}`网络号和主机号都是0 表示本网络上的本主机，只能用作源地址
2. `{-1,-1}`即255.255.255.255 用于本网络上的广播，只能用作目的地址
3. `{127,}`即网络号为127的任意IP地址。都是内部主机回环地址，永远不可能出现主机之外的网络

D类是组播地址，使用这一类地址，属于某个组的机器都能收到

### 公有IP地址和私有IP地址

**私有IP**地址允许组织内部的IT人员自己管理、自己分配，而且可以重复

---

1. IP设计时犯的错误？

低估了未来网络的发展：32位地址不够用。于是有了现在IPv6（128位）

分类错误：分成了5类。C类太少，B类太多。C类254个，网络都不够；D类6万多，给企业都太多。


2. 后来者如何弥补IP设计者犯的错误呢？

**CIDR**，无类型域间选路。
打破原来几类地址设计的做法，将32位IP地址一分二，前者网络号，后者主机号。
如何分呢？
比如：10.100.122.2/24
24 = 前24位是网络号，那么后8位就是主机号。
那如何用？
如发送行信息给 10.100.122.255
所有以 10.100.122.X 开头的机器都能收到。
于是有了两个概念：
广播地址：10.100.122.255
子网掩码：255.255.255.0 -> AND 得到网络号10.100.122.0


3. 127.0.0.1 与 0.0.0.0 有什么不同？

- 都属于特殊地址
- 都属于A类地址
- 127.0.0.1是一个回环地址，并不表示本机
- 0.0.0.0表示本网络中的主机

如果一台服务器拥有外网地址与内网地址，那么绑定端口0.0.0.0 那么通过内网地址或外网地址都可以访问

**0.0.0.0**

IPV4中，0.0.0.0地址被用于表示一个无效的，未知的或者不可用的目标。

- 在服务器中，0.0.0.0指的是本机上的所有IPV4地址，如果一个主机有两个IP地址，192.168.1.1 和 10.1.2.1，并且该主机上的一个服务监听的地址是0.0.0.0,那么通过两个ip地址都能够访问该服务。
- 在路由中，0.0.0.0表示的是默认路由，即当路由表中没有找到完全匹配的路由的时候所对应的路由。

- 当一台主机还没有被分配一个IP地址的时候，用于表示主机本身。（DHCP分配IP地址的时候）
- 用作默认路由，表示”任意IPV4主机”。 用来表示目标机器不可用。
- 用作服务端，表示本机上的任意IPV4地址

**127.0.0.1**

127.0.0.1属于{127,}集合中的一个，而所有网络号为127的地址都被称之为回环地址，所以回环地址！=127.0.0.1,它们是包含关系，即回环地址包含127.0.0.1。 回环地址：所有发往该类地址的数据包都应该被loop back。

**localhost**

localhost是个域名，而不是一个ip地址。之所以我们经常把localhost与127.0.0.1认为是同一个是因为我们使用的大多数电脑上都讲localhost指向了127.0.0.1这个地址

Linux系统中`/etc/hosts`

```shell
127.0.0.1       localhost       localhost.localdomain   localhost4      localhost4.localdomain4
::1     localhost       localhost.localdomain   localhost6      localhost6.localdomain6
172.19.68.108   iZuf6aezijrwku50v6qusrZ iZuf6aezijrwku50v6qusrZ
```

localhost是一个域名，用于指代本电脑可以用它来获取运行在本机上的网络服务



